packages

```{r}
library(tidyverse)
library(conflicted)
conflict_prefer("filter", "dplyr")
```

get general stuff

```{r}
games <- read_rds("../scoresway/rds/games.rds")
league_ids <- readRDS("~/Documents/r-projects/ratings/league_ids.rds")
```

get stuff for a country

```{r, message=FALSE}
get_country <- function(this_league, league_ids, prior_year = 2021) {
  league_ids %>% 
    mutate(row = row_number()) %>% 
    filter(row == this_league) -> d
  country_name <- d$the_country
  country_lower <- tolower(country_name)
  country_comps <- d$id[[1]]
  rating_dir <- "../ratings/"
  priorname <- str_c(rating_dir, 
                     country_lower, 
                     prior_year,
                     "_prior.csv")
  postname <- str_c(rating_dir, country_lower,"_post.rds")
  prior <- read_csv(priorname)
  read_rds(postname) %>% rstan::extract() -> rat
  
  list(name = country_name, comps = country_comps, 
       prior = prior, rat = rat)
}
country_list <- get_country(2, league_ids) 
```


